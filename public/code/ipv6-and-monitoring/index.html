<!doctype html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="author" content="Ronny Trommer">
        <meta name="description" content="Private blog around tech and live.">
        <meta name="keywords" content="blog,personal,responsive,search,font awesome,pages,posts,multilingual,highlight.js,syntax highlighting,premium,shortcuts">
        <meta name="generator" content="Hugo 0.55.4" />
        <title> IPv6 and Monitoring | no42</title>
        <meta name="description" content="IPv6 and Monitoring - Private blog around tech and live.">
        <meta itemprop="name" content="IPv6 and Monitoring">
        <meta itemprop="description" content="IPv6 and Monitoring - Private blog around tech and live.">
        <meta property="og:title" content="IPv6 and Monitoring">
        <meta property="og:description" content="IPv6 and Monitoring - Private blog around tech and live.">
        <meta property="og:image" content="https://www.gravatar.com/avatar/7f19843706ee328d5b1dfbf9b2a73a73?size=200">
        <meta property="og:url" content="https://blog.no42.org/code/ipv6-and-monitoring/">
        <meta property="og:site_name" content="no42">
        <meta property="og:type" content="article">
        <link rel="icon" type="image/png" href="https://blog.no42.org/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="https://blog.no42.org/favicon-16x16.png" sizes="16x16">

	

        
        
        
        
        <link rel="stylesheet" href="https://blog.no42.org/sass/combined.min.6e8351b3ea65d753e797df34276a01509dc8ac2d5d2f5d5b13934de1e37d5d44.css">

        

        
            
        
    </head>
    <body class="bilberry-hugo-theme">
        
<nav>

    <div class="container">
        <ul class="topnav">
            
                
                    <li><a href="/page/projects/">Projects</a></li>
                
            
                
                    <li><a href="/page/about/">About Me</a></li>
                
            
                
                    <li><a href="/page/impressum/">Impressum</a></li>
                
            
                
                    <li><a href="/page/privacy/">Privacy</a></li>
                
            
        </ul>

        
    </div>
</nav>


        <header>
    <div class="container">
        <div class="logo">
            <a href="/" class="logo">
                
                    <img src="/images/gravatar.jpg" alt="">
                

                <span class="overlay"><i class="fa fa-home"></i></span>
            </a>
        </div>
        <div class="titles">
            <h3 class="title"><a href="/">no42</a></h3>
            
                <span class="subtitle">... search for answer?</span>
            
        </div>

    

        
        <div class="toggler">
        
            <i class="fa fa-bars" aria-hidden="true"></i>
        </div>
    </div>
</header>


        <div class="main container">
            
     
    <div class="article-wrapper u-cf single">
        
            <a class="bubble" href="/code/ipv6-and-monitoring/">
    <i class="fa fa-fw fa-code"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="/code/ipv6-and-monitoring/">IPv6 and Monitoring</a></h3>
    <div class="meta">
        
            
                <span class="date moment">2016-03-19</span>
            
        

        
            <span class="readingTime">3 min read</span>
        

        

        
            <span class="author"><a href="/author/ronny-trommer">Ronny Trommer</a></span>
        
    </div>

    
        <p>We are all happy when we are able to get IPv6 connectivity for our new servers.
In case the network is provided by someone else and some kernel settings you can get in some tricky situations.</p>

<p>With IPv6 there are so many addresses your Laptop and Mobile can have a unique public IPv6 address forever - pretty cool huh?
The downside is, it would be pretty easy to trace every connection you ever do back to your device - this really not what you want!
When you provide a service this behavior is not so useful.
Otherwise there are several ways to autoconfigure your IPv6 configuration, beside DHCPv6 the interesting one is stateless address configuration.</p>

<p>Stateless address configuration means, your server is allowed to construct himself an IPv6 address without the need of DHCPv6 server.
Simple explained, a router with IPv6 runs the Router Advertisement daemon.
He sends via link local router advertisement (RA) packets and inform others &ldquo;Hey! I&rsquo;m the default router for the 2001::/64 network&rdquo;.
This advertisements are sent out at a certain interval and this way your server gets the information what the LAN IPv6 network is.</p>

<p>The RA packets can have some flags:</p>

<ul>
<li><code>A</code>: Autonomous Address Autoconfiguration tells your server it should perform a <a href="http://tools.ietf.org/html/rfc4862">stateless address assignment</a></li>
<li><code>M</code>: Managed Address Configuration tells your server it should use stateful DHCPv6 to acquire its address and other DHCPv6 options</li>
</ul>

<p>With the flag set to <code>A</code> your server will create an IPv6 address in the given network space.
To make your server &ldquo;untracable&rdquo; the <a href="https://tools.ietf.org/html/rfc4941">Privacy Extensions</a> kicks in and basically randomizes and changes your IPv6 address over time.</p>

<p>You can verify the configuration with</p>

<pre><code class="language-sh">sysctl -a | grep use_temp

net.ipv6.conf.VPN.use_tempaddr = 2
net.ipv6.conf.all.use_tempaddr = 2
net.ipv6.conf.default.use_tempaddr = 2
net.ipv6.conf.em1.use_tempaddr = 2
net.ipv6.conf.em2.use_tempaddr = 2
net.ipv6.conf.lo.use_tempaddr = 2
</code></pre>

<p>In Ubuntu you can set the kernel settings so they survive a restart set the configuration in</p>

<pre><code class="language-sh">cat /etc/sysctl.d/10-ipv6-privacy.conf

net.ipv6.conf.all.use_tempaddr = 2
net.ipv6.conf.default.use_tempaddr = 2
</code></pre>

<p>If you want to set the parameter as default for every new network device set</p>

<pre><code class="language-sh">sysctl -w net.ipv6.conf.all.use_tempaddr=0
sysctl -w net.ipv6.conf.default.use_tempaddr = 0
</code></pre>

<p>This setting can also be configured for a specific interfaces, here the command for <code>eth0</code></p>

<pre><code class="language-sh">sysctl -w net.ipv6.conf.eth0.use_tempaddr=0
</code></pre>

<p>If you have the kernel settings set to <code>2</code> means prefer privacy addresses and use them over the normal address.
Set the kernel parameter to <code>0</code> to disable privacy extensions.</p>

<p>OpenNMS uses SNMP and during the provisioning and discovers IPv6 addresses.
For the provisioning there are not a lot of possibilities to figure out if an interface is down or doesn&rsquo;t exist anymore.
If you have Privacy Extentions enabled your server looks somehow like the screenshot below.</p>

<p><img src="/images/ipv6-temporary-address-with-privacy-extensions.png" alt="OpenNMS with IPv6 temporary addresses" /></p>

<p>In this situation you can exclude the IP interfaces with an IP match policy or you disable Privacy Extensions on your server.</p>

<p>Links around this topic:</p>

<ul>
<li><a href="http://www.finnie.org/2012/06/10/ipv6-autoconfiguration-in-a-nutshell/">IPv6 autoconfiguration in a nutshell</a></li>
<li><a href="https://community.infoblox.com/t5/IPv6-Center-of-Excellence/Why-You-Must-Use-ICMPv6-Router-Advertisements-RAs/ba-p/3416">ICMPv6 and Router Advertisements</a></li>
<li><a href="http://computernetworkingnotes.com/ipv6-features-concepts-and-configurations/install-ipv6.html">IPv6 Address Auto configuration Process</a></li>
<li><a href="https://sites.google.com/site/amitsciscozone/home/important-tips/ipv6/ipv6-stateless-autoconfiguration">IPv6 Stateless Autoconfiguration</a></li>
<li><a href="https://wiki.ubuntuusers.de/IPv6/Privacy_Extensions/">IPv6 Privacy Extensions</a></li>
<li><a href="http://docs.opennms.org/opennms/branches/develop/guide-admin/guide-admin.html#_advanced_provisioning_example">OpenNMS Advanced Provisioning Example</a></li>
</ul>

    
</div>

    
<div class="footer">


    
        <div class="tags">
            <i class="fa fa-tags"></i>
            <div class="links">
                
                    <a href="/tags/linux">linux</a>
                
                    <a href="/tags/ipv6">ipv6</a>
                
                    <a href="/tags/networking">networking</a>
                
            </div>
        </div>
    

    
</div>

</article>

        
    </div>

    
        
    

     

        </div>

        
<footer>
    <div class="container">

        
        <div class="recent-posts">
            <strong>Latest posts</strong>
                <ul>
                
                    <li>
                        <a href="/code/docker-build-cache-invalidation/">Docker, Caching, Build</a>
                    </li>
                
                    <li>
                        <a href="/code/docker-java-signals-pid1/">Docker, Java, Signals and Pid 1</a>
                    </li>
                
                    <li>
                        <a href="/code/ssl-and-java/">SSL and Java</a>
                    </li>
                
                    <li>
                        <a href="/article/opennms-notify-signal/">Send notifications with Signal</a>
                    </li>
                
                    <li>
                        <a href="/article/theming-applications/">Everyone can change it and why you shouldn&#39;t</a>
                    </li>
                
                    <li>
                        <a href="/article/guidance-to-survive-monitoring/">Guidance to Survive Monitoring</a>
                    </li>
                
                    <li>
                        <a href="/quote/two-hard-things/">Two hard things</a>
                    </li>
                
                </ul>
        </div>
        

        

        <div class="right">
            
            <div class="external-profiles">
                <strong>Social media</strong>

                
                
                    <a href="https://twitter.com/indigo423" target="_blank"><i class="fa fa-twitter-adblock-proof"></i></a>
                
                
                
                    <a href="https://www.xing.com/profile/Ronny_Trommer" target="_blank"><i class="fa fa-xing"></i></a>
                
                
                
                
                
                
                
                    <a href="https://github.com/indigo423" target="_blank"><i class="fa fa-github"></i></a>
                
                
                    <a href="https://www.linkedin.com/in/ronnytrommer/" target="_blank"><i class="fa fa-linkedin"></i></a>
                
            </div>
            

            <div class="languages">
                    <strong>Other languages</strong>
                    
                        
                            <a href="/en" class="active">en</a>
                        
                    
                        
                            <a href="/de">de</a>
                        
                    
                </div>
            
        </div>
    </div>
</footer>


<div class="credits">
    <div class="container">
        <div class="copyright">
            <a href="https://github.com/indigo423" target="_blank">
                &copy;
                
                    2019
                
                by Ronny Trommer
            </a>
	    
        </div>
        <div class="author">
            <a href="https://github.com/Lednerb/bilberry-hugo-theme" target="_blank">Bilberry Hugo Theme</a>
        </div>
    </div>
</div>


        
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-73787628-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


        

        
        
        <script type="text/javascript" src="https://blog.no42.org/js/externalDependencies.39c47e10e241eae2947b3fe21809c572.js" integrity="md5-OcR&#43;EOJB6uKUez/iGAnFcg=="></script>

        
        
        <script type="text/javascript" src="https://blog.no42.org/js/theme.ff50ae6dc1bfc220b23bf69dbb41b54e.js" integrity="md5-/1CubcG/wiCyO/adu0G1Tg=="></script>

        <script>
            $(".moment").each(function() {
                $(this).text(
                    moment( $(this).text() )
                        .locale( "en" )
                        .format('LL')
                );
            });

            $(".footnote-return sup").html("");
        </script>

        
            
        

        


    </body>
</html>
